<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø¥ØµÙ„Ø§Ø­ Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø«Ù„Ø§Ø«Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .content {
            padding: 30px;
        }

        .test-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid #3498db;
        }

        .test-section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }

        .user-test {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .user-test:hover {
            border-color: #3498db;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.1);
        }

        .user-info {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            margin-left: 15px;
        }

        .user-omar { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .user-mohammed { background: linear-gradient(135deg, #27ae60, #229954); }
        .user-abu-tameem { background: linear-gradient(135deg, #f39c12, #e67e22); }

        .user-details h4 {
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .user-details p {
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        .test-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Cairo', sans-serif;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .log {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            max-height: 400px;
            overflow-y: auto;
            line-height: 1.6;
        }

        .log-entry {
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .log-success { color: #2ecc71; }
        .log-error { color: #e74c3c; }
        .log-warning { color: #f39c12; }
        .log-info { color: #3498db; }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 8px;
        }

        .status-success { background: #2ecc71; }
        .status-error { background: #e74c3c; }
        .status-warning { background: #f39c12; }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .content {
                padding: 20px;
            }
            
            .test-buttons {
                flex-direction: column;
            }
            
            .btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-bug"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø¥ØµÙ„Ø§Ø­ Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</h1>
            <p>Ø§Ø®ØªØ¨Ø§Ø± ÙØªØ­ Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø«Ù„Ø§Ø«Ø©: Ø¹Ù…Ø±ØŒ Ù…Ø­Ù…Ø¯ØŒ ÙˆØ£Ø¨Ùˆ ØªÙ…ÙŠÙ…</p>
        </div>

        <div class="content">
            <div class="test-section">
                <h3><i class="fas fa-users"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
                
                <!-- Ø¹Ù…Ø± - Ø§Ù„Ù…Ø¯ÙŠØ± -->
                <div class="user-test">
                    <div class="user-info">
                        <div class="user-avatar user-omar">
                            <i class="fas fa-crown"></i>
                        </div>
                        <div class="user-details">
                            <h4>Ø¹Ù…Ø± - Ø§Ù„Ù…Ø¯ÙŠØ±</h4>
                            <p>ØµÙ„Ø§Ø­ÙŠØ§Øª ÙƒØ§Ù…Ù„Ø©: Ø¹Ø±Ø¶ØŒ Ø±ÙØ¹ØŒ Ø­Ø°Ù Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª</p>
                        </div>
                    </div>
                    <div class="test-buttons">
                        <button class="btn btn-primary" onclick="testUserAttachments('Ø¹Ù…Ø±', '159')">
                            <i class="fas fa-sign-in-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ÙƒØ¹Ù…Ø±
                        </button>
                        <button class="btn btn-success" onclick="testCardAttachments('Ø¹Ù…Ø±')">
                            <i class="fas fa-paperclip"></i> Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
                        </button>
                    </div>
                </div>

                <!-- Ù…Ø­Ù…Ø¯ - Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ -->
                <div class="user-test">
                    <div class="user-info">
                        <div class="user-avatar user-mohammed">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <div class="user-details">
                            <h4>Ù…Ø­Ù…Ø¯ - Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯</h4>
                            <p>ØµÙ„Ø§Ø­ÙŠØ§Øª ÙƒØ§Ù…Ù„Ø©: Ø¹Ø±Ø¶ØŒ Ø±ÙØ¹ØŒ Ø­Ø°Ù Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª</p>
                        </div>
                    </div>
                    <div class="test-buttons">
                        <button class="btn btn-primary" onclick="testUserAttachments('Ù…Ø­Ù…Ø¯', 'm12345')">
                            <i class="fas fa-sign-in-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø­Ù…Ø¯
                        </button>
                        <button class="btn btn-success" onclick="testCardAttachments('Ù…Ø­Ù…Ø¯')">
                            <i class="fas fa-paperclip"></i> Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
                        </button>
                    </div>
                </div>

                <!-- Ø£Ø¨Ùˆ ØªÙ…ÙŠÙ… - Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø­Ø¯ÙˆØ¯ -->
                <div class="user-test">
                    <div class="user-info">
                        <div class="user-avatar user-abu-tameem">
                            <i class="fas fa-eye"></i>
                        </div>
                        <div class="user-details">
                            <h4>Ø£Ø¨Ùˆ ØªÙ…ÙŠÙ… - Ø´Ø±ÙƒØ© Ø§Ù„Ø³Ù†ÙŠØ¯ÙŠ</h4>
                            <p>ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø­Ø¯ÙˆØ¯Ø©: Ø¹Ø±Ø¶ ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª ÙÙ‚Ø·</p>
                        </div>
                    </div>
                    <div class="test-buttons">
                        <button class="btn btn-primary" onclick="testUserAttachments('1234', '1234')">
                            <i class="fas fa-sign-in-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ÙƒØ£Ø¨Ùˆ ØªÙ…ÙŠÙ…
                        </button>
                        <button class="btn btn-warning" onclick="testCardAttachments('1234')">
                            <i class="fas fa-paperclip"></i> Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
                        </button>
                    </div>
                </div>
            </div>

            <div class="test-section">
                <h3><i class="fas fa-cogs"></i> Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
                <div class="test-buttons">
                    <button class="btn btn-success" onclick="checkSystemStatus()">
                        <i class="fas fa-heartbeat"></i> ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
                    </button>
                    <button class="btn btn-primary" onclick="testAllUsers()">
                        <i class="fas fa-users-cog"></i> Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                    </button>
                    <button class="btn btn-warning" onclick="clearLog()">
                        <i class="fas fa-broom"></i> Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„
                    </button>
                </div>
            </div>

            <div class="test-section">
                <h3><i class="fas fa-clipboard-list"></i> Ø³Ø¬Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
                <div id="testLog" class="log">
                    <div class="log-entry log-info">
                        <i class="fas fa-info-circle"></i> Ø¬Ø§Ù‡Ø² Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ØªØ¶Ù…ÙŠÙ† Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="script.js"></script>

    <script>
        // Ø¯ÙˆØ§Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
        function log(message, type = 'info') {
            const logDiv = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString('ar-SA');
            const iconMap = {
                'success': 'fas fa-check-circle',
                'error': 'fas fa-exclamation-triangle', 
                'warning': 'fas fa-exclamation-circle',
                'info': 'fas fa-info-circle'
            };
            
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.innerHTML = `
                <i class="${iconMap[type]}"></i>
                [${timestamp}] ${message}
            `;
            
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function clearLog() {
            document.getElementById('testLog').innerHTML = `
                <div class="log-entry log-info">
                    <i class="fas fa-info-circle"></i> ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„ - Ø¬Ø§Ù‡Ø² Ù„Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯...
                </div>
            `;
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            log('ğŸš€ Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø¥ØµÙ„Ø§Ø­ Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø«Ù„Ø§Ø«Ø©...', 'info');
            
            // ØªÙ‡ÙŠØ¦Ø© Supabase
            if (typeof initSupabase === 'function') {
                const initialized = initSupabase();
                log('Supabase ØªÙ‡ÙŠØ¦Ø©: ' + (initialized ? 'Ù†Ø¬Ø­' : 'ÙØ´Ù„'), initialized ? 'success' : 'error');
            }
        });

        async function testUserAttachments(username, password) {
            log(`ğŸ” Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${username}`, 'info');
            
            try {
                // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                if (typeof handleLogin === 'function') {
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø¯Ø« ÙˆÙ‡Ù…ÙŠ
                    const mockEvent = {
                        preventDefault: () => {},
                        target: {
                            username: { value: username },
                            password: { value: password }
                        }
                    };
                    
                    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    await handleLogin(mockEvent);
                    log(`âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ${username} Ø¨Ù†Ø¬Ø§Ø­`, 'success');
                } else {
                    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©
                    if (typeof users !== 'undefined' && users[username] && users[username].password === password) {
                        if (typeof setCurrentUser === 'function') {
                            setCurrentUser(username);
                            log(`âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ${username} Ø¨Ù†Ø¬Ø§Ø­ (Ø·Ø±ÙŠÙ‚Ø© Ù…Ø¨Ø§Ø´Ø±Ø©)`, 'success');
                        }
                    } else {
                        throw new Error('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
                    }
                }
                
                // ÙØ­Øµ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
                checkUserPermissions(username);
                
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ${username}: ${error.message}`, 'error');
            }
        }

        function checkUserPermissions(username) {
            log(`ğŸ” ÙØ­Øµ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${username}`, 'info');
            
            if (typeof isAuthorizedUser === 'function') {
                const canUpload = isAuthorizedUser();
                log(`ğŸ“¤ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø±ÙØ¹: ${canUpload ? 'Ù†Ø¹Ù…' : 'Ù„Ø§'}`, canUpload ? 'success' : 'warning');
            }
            
            if (typeof canViewAttachments === 'function') {
                const canView = canViewAttachments();
                log(`ğŸ‘ï¸ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¹Ø±Ø¶: ${canView ? 'Ù†Ø¹Ù…' : 'Ù„Ø§'}`, canView ? 'success' : 'error');
            }
        }

        function testCardAttachments(username) {
            log(`ğŸ·ï¸ Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${username}`, 'info');
            
            if (typeof showCardAttachmentsModal === 'function') {
                try {
                    showCardAttachmentsModal('Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ù…Ø¬Ù…Ø¹_Ø§Ø®ØªØ¨Ø§Ø±_Ø§Ù„Ø¥ØµÙ„Ø§Ø­', '123', null);
                    log(`âœ… ØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${username}`, 'success');
                    
                    // ÙØ­Øµ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¨Ø¹Ø¯ ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø©
                    setTimeout(() => {
                        checkModalElements(username);
                    }, 1000);
                    
                } catch (error) {
                    log(`âŒ Ø®Ø·Ø£ ÙÙŠ ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª: ${error.message}`, 'error');
                }
            } else {
                log('âŒ ÙˆØ¸ÙŠÙØ© showCardAttachmentsModal ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©', 'error');
            }
        }

        function checkModalElements(username) {
            log(`ğŸ” ÙØ­Øµ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù†Ø§ÙØ°Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${username}`, 'info');
            
            // ÙØ­Øµ ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù†Ø§ÙØ°Ø©
            const modal = document.querySelector('.modal-overlay');
            if (modal) {
                log('âœ… Ø§Ù„Ù†Ø§ÙØ°Ø© Ù…ÙØªÙˆØ­Ø©', 'success');
                
                // ÙØ­Øµ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±ÙØ¹
                const uploadArea = document.querySelector('.upload-area, .mobile-upload-section');
                if (uploadArea) {
                    const isVisible = uploadArea.style.display !== 'none' && !uploadArea.hidden;
                    log(`ğŸ“¤ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±ÙØ¹: ${isVisible ? 'Ù…Ø±Ø¦ÙŠØ©' : 'Ù…Ø®ÙÙŠØ©'}`, isVisible ? 'success' : 'warning');
                }
                
                // ÙØ­Øµ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª
                const attachmentsList = document.querySelector('.attachments-list, .mobile-attachments-list');
                if (attachmentsList) {
                    log('âœ… Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª Ù…ÙˆØ¬ÙˆØ¯Ø©', 'success');
                } else {
                    log('âš ï¸ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©', 'warning');
                }
                
                // ÙØ­Øµ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠØ©
                const limitedNotice = document.querySelector('.limited-user-notice');
                if (limitedNotice) {
                    log('â„¹ï¸ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø­Ø¯ÙˆØ¯ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ù…ÙˆØ¬ÙˆØ¯Ø©', 'info');
                }
                
            } else {
                log('âŒ Ø§Ù„Ù†Ø§ÙØ°Ø© ØºÙŠØ± Ù…ÙØªÙˆØ­Ø©', 'error');
            }
        }

        function checkSystemStatus() {
            log('ğŸ” ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…...', 'info');
            
            // ÙØ­Øµ Supabase
            if (typeof supabaseClient !== 'undefined' && supabaseClient) {
                log('âœ… Supabase Client Ù…ØªÙˆÙØ±', 'success');
            } else {
                log('âŒ Supabase Client ØºÙŠØ± Ù…ØªÙˆÙØ±', 'error');
            }
            
            // ÙØ­Øµ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            const requiredFunctions = [
                'showCardAttachmentsModal',
                'isAuthorizedUser', 
                'canViewAttachments',
                'handleCardFileUploadEnhanced'
            ];
            
            requiredFunctions.forEach(funcName => {
                if (typeof window[funcName] === 'function') {
                    log(`âœ… ${funcName} Ù…ØªÙˆÙØ±Ø©`, 'success');
                } else {
                    log(`âŒ ${funcName} ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©`, 'error');
                }
            });
        }

        async function testAllUsers() {
            log('ğŸ§ª Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†...', 'info');
            
            const users = [
                { username: 'Ø¹Ù…Ø±', password: '159', name: 'Ø¹Ù…Ø± - Ø§Ù„Ù…Ø¯ÙŠØ±' },
                { username: 'Ù…Ø­Ù…Ø¯', password: 'm12345', name: 'Ù…Ø­Ù…Ø¯ - Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯' },
                { username: '1234', password: '1234', name: 'Ø£Ø¨Ùˆ ØªÙ…ÙŠÙ… - Ø´Ø±ÙƒØ© Ø§Ù„Ø³Ù†ÙŠØ¯ÙŠ' }
            ];
            
            for (const user of users) {
                log(`\n--- Ø§Ø®ØªØ¨Ø§Ø± ${user.name} ---`, 'info');
                await testUserAttachments(user.username, user.password);
                await new Promise(resolve => setTimeout(resolve, 1000));
                testCardAttachments(user.username);
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¥Ù† ÙƒØ§Ù†Øª Ù…ÙØªÙˆØ­Ø©
                if (typeof closeModal === 'function') {
                    closeModal();
                }
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
            
            log('ğŸ‰ Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø§Ù…Ù„', 'success');
        }
    </script>
</body>
</html>
