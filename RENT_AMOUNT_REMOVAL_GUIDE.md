# ุฅุฒุงูุฉ ุนููุฏ rent_amount ูู ุงูุชุทุจูู

## ๐ ุงููุดููุฉ
ูุงู ุงูุชุทุจูู ูุญุงูู ุงุณุชุฎุฏุงู ุนููุฏ `rent_amount` ูู ุฌุฏูู `properties` ููุง ูุณุจุจ ุงูุฎุทุฃ:
```
Could not find the 'rent_amount' column of 'properties' in the schema cache
```

ุงููุณุชุฎุฏู ูุง ูุญุชุงุฌ ููุฐุง ุงูุนููุฏ ูููุชูู ุจู `rent_value` ูุงูุฅุฌูุงูู.

## โ ุงูุญู ุงููุทุจู

### 1. ุชุญุฏูุซ ุงูููุฏ ูู script.js

#### ุงูุฏูุงู ุงููุณุงุนุฏุฉ (ุงูุณุทูุฑ 73-82):
```javascript
// ูุจู ุงูุชุนุฏูู
function getRentValue(property) {
    return property.rent_amount || property.rent_value || null;
}

function setRentValue(propertyData, rentValue) {
    propertyData.rent_amount = rentValue;
    propertyData.rent_value = rentValue;
    return propertyData;
}

// ุจุนุฏ ุงูุชุนุฏูู
function getRentValue(property) {
    return property.rent_value || null;
}

function setRentValue(propertyData, rentValue) {
    propertyData.rent_value = rentValue;
    return propertyData;
}
```

#### ุฅุฒุงูุฉ rent_amount ูู ุนูููุงุช ุฅูุดุงุก ุงูุจูุงูุงุช:
- ุงูุณุทุฑ 20614: ุฅุฒุงูุฉ `rent_amount` ูู ุจูุงูุงุช ุงูุฎุตุงุฆุต
- ุงูุณุทุฑ 22258: ุฅุฒุงูุฉ `rent_amount` ูู ุชุนุฑูู ุงูุฌุฏูู
- ุงูุณุทุฑ 22314: ุฅุฒุงูุฉ `rent_amount` ูู ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ
- ุงูุณุทุฑ 22371: ุฅุฒุงูุฉ `rent_amount` ูู ูุนุงูุฌุฉ ุงูุจูุงูุงุช

### 2. ููู SQL ูุฅุฒุงูุฉ ุงูุนููุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

ุชู ุฅูุดุงุก `remove-rent-amount-column.sql` ุงูุฐู ูููู ุจู:

#### ุฅุฒุงูุฉ ุงูุนููุฏ ูุงูููููุงุช ุงููุชุนููุฉ ุจู:
```sql
-- ุฅุฒุงูุฉ trigger ุชุฒุงูู ุฃุนูุฏุฉ ุงูุฅูุฌุงุฑ
DROP TRIGGER IF EXISTS sync_rent_columns_trigger ON properties;

-- ุฅุฒุงูุฉ ุงูุฏุงูุฉ ุงููุชุนููุฉ ุจุชุฒุงูู ุฃุนูุฏุฉ ุงูุฅูุฌุงุฑ
DROP FUNCTION IF EXISTS sync_rent_columns();

-- ุฅุฒุงูุฉ ููุฑุณ rent_amount
DROP INDEX IF EXISTS idx_properties_rent_amount;

-- ุฅุฒุงูุฉ ุนููุฏ rent_amount
ALTER TABLE properties DROP COLUMN IF EXISTS rent_amount;
```

#### ุฅูุดุงุก ููููุงุช ูุญุณูุฉ ูู rent_value:
```sql
-- ุฅูุดุงุก ููุฑุณ ูุญุณู ูุนููุฏ rent_value
CREATE INDEX IF NOT EXISTS idx_properties_rent_value 
ON properties(rent_value) 
WHERE rent_value IS NOT NULL AND rent_value > 0;

-- ุฅูุดุงุก view ููุจูุงูุงุช ุงููุงููุฉ
CREATE OR REPLACE VIEW financial_summary AS
SELECT 
    id, unit_number, property_name, tenant_name,
    rent_value, total_amount, paid_amount, remaining_amount,
    CASE WHEN rent_value > 0 THEN 'ูุคุฌุฑ' ELSE 'ุดุงุบุฑ' END as rental_status
FROM properties
WHERE tenant_name IS NOT NULL AND tenant_name != '';
```

### 3. ุฃุฏุงุฉ ุงุฎุชุจุงุฑ ุดุงููุฉ

ุชู ุฅูุดุงุก `test-without-rent-amount.html` ููุชุญูู ูู:

- โ ุงูุงุชุตุงู ุจู Supabase
- โ ุนุฏู ูุฌูุฏ ุนููุฏ `rent_amount`
- โ ุนูู ุนููุฏ `rent_value` ุจุดูู ุทุจูุนู
- โ ุนูู ุงูุฏูุงู ุงููุณุงุนุฏุฉ ุงููุญุฏุซุฉ
- โ ุญุณุงุจ ุงูุฅุญุตุงุฆูุงุช ุงููุงููุฉ
- โ ุนูู ุงูุชุทุจูู ุจุดูู ูุงูู

## ๐ ุฎุทูุงุช ุงูุชุทุจูู

### 1. ุชุทุจูู ุชุบููุฑุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช:
```bash
# ุชุดุบูู ููู SQL ูุฅุฒุงูุฉ ุงูุนููุฏ
psql -h your-host -d your-database -f remove-rent-amount-column.sql
```

### 2. ุงุฎุชุจุงุฑ ุงูุชุทุจูู:
- ุงูุชุญ `test-without-rent-amount.html` ูู ุงููุชุตูุญ
- ุงุถุบุท ุนูู "ุชุดุบูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช"
- ุชุฃูุฏ ูู ูุฌุงุญ ุฌููุน ุงูุงุฎุชุจุงุฑุงุช

### 3. ุงุฎุชุจุงุฑ ุงูุชุทุจูู ุงูุฃุณุงุณู:
- ุงูุชุญ `index.html`
- ุชุฃูุฏ ูู ุนุฏู ุธููุฑ ุฎุทุฃ `rent_amount`
- ุชุฃูุฏ ูู ุนูู ุฌููุน ุงููุธุงุฆู ุงููุงููุฉ

## ๐ ุงูุจูุงูุงุช ุงููุงููุฉ ุงูุขู

ุงูุชุทุจูู ูุณุชุฎุฏู ุงูุขู:
- **rent_value**: ูููุฉ ุงูุฅูุฌุงุฑ ุงูุฃุณุงุณูุฉ
- **total_amount**: ุงูุฅุฌูุงูู (ูุน ุงูุถุฑูุจุฉ)
- **paid_amount**: ุงููุจูุบ ุงููุฏููุน
- **remaining_amount**: ุงููุจูุบ ุงููุชุจูู

## ๐ ุงูุชุญูู ูู ุงููุฌุงุญ

### ุนูุงูุงุช ุงููุฌุงุญ:
- โ ุนุฏู ุธููุฑ ุฎุทุฃ "Could not find the 'rent_amount' column"
- โ ุนูู ุฌููุน ุงููุธุงุฆู ุงููุงููุฉ
- โ ุนุฑุถ ุงูุจูุงูุงุช ุจุดูู ุตุญูุญ
- โ ุนูู ุงูุชุตุฏูุฑ ูุงูููุงุชุฑ

### ูู ุญุงูุฉ ูุฌูุฏ ูุดุงูู:
1. ุชุฃูุฏ ูู ุชุทุจูู ููู SQL ุจูุฌุงุญ
2. ุงูุณุญ cache ุงููุชุตูุญ
3. ุชุฃูุฏ ูู ุชุญุฏูุซ ููู script.js
4. ุงุณุชุฎุฏู ุฃุฏุงุฉ ุงูุงุฎุชุจุงุฑ ููุชุดุฎูุต

## ๐ ุงููููุงุช ุงููุญุฏุซุฉ

- โ `script.js` - ุฅุฒุงูุฉ ุฌููุน ูุฑุงุฌุน rent_amount
- โ `remove-rent-amount-column.sql` - ุฅุฒุงูุฉ ุงูุนููุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ `test-without-rent-amount.html` - ุฃุฏุงุฉ ุงุฎุชุจุงุฑ ุดุงููุฉ
- โ `RENT_AMOUNT_REMOVAL_GUIDE.md` - ูุฐุง ุงูููู (ุงูุชูุซูู)

## ๐ก ููุงุญุธุงุช ูููุฉ

1. **ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ**: ุชุฃูุฏ ูู ุนูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุจู ุชุทุจูู ุงูุชุบููุฑุงุช
2. **ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ**: ุฌููุน ุงูุจูุงูุงุช ูู `rent_value` ุณุชุจูู ููุง ูู
3. **ุงูุชูุงูู**: ุงูุชุทุจูู ุณูุนูู ุจุดูู ุทุจูุนู ูุน ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ
4. **ุงูุฃุฏุงุก**: ุฅุฒุงูุฉ ุงูุนููุฏ ุบูุฑ ุงููุณุชุฎุฏู ุณูุญุณู ุงูุฃุฏุงุก ููููุงู

## ๐ฏ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

ุงูุชุทุจูู ุงูุขู:
- โ ูุง ูุณุชุฎุฏู ุนููุฏ `rent_amount`
- โ ูุณุชุฎุฏู `rent_value` ููุท ููุฅูุฌุงุฑ
- โ ูุนุชูุฏ ุนูู ุงูุฅุฌูุงูู ููุญุณุงุจุงุช ุงููุงููุฉ
- โ ูุนูู ุจุฏูู ุฃุฎุทุงุก schema cache
- โ ูุญุณู ููุฃุฏุงุก ูุงูุจุณุงุทุฉ
