# ๐ ุฏููู ุฅุนุฏุงุฏ ุฌุฏูู ุณุฌูุงุช ุงูุชุชุจุน ุงููุฎุตุต

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅูุดุงุก ูุธุงู ุณุฌูุงุช ุงูุชุชุจุน ุงููุฎุตุต ูุญูุธ ุฌููุน ุงูุชุบููุฑุงุช ูุงูุนูููุงุช ูู ุฌุฏูู ูููุตู `tracking_logs` ูู Supabaseุ ููุง ูุถูู:

- โ **ุนุฏู ุงูุชุฏุงุฎู** ูุน ุฌุฏูู ุงูุนูุงุฑุงุช ุงูุฑุฆูุณู
- โ **ูุดุงุฑูุฉ ุงูุณุฌูุงุช** ุจูู ุฌููุน ุงููุณุชุฎุฏููู
- โ **ุฃุฏุงุก ุฃูุถู** ูุน ููุฑุณุฉ ูุญุณูุฉ
- โ **ูุฑููุฉ ูู ุงูุจุญุซ** ูุงูุชุตููุฉ
- โ **ุฅุญุตุงุฆูุงุช ูุชูุฏูุฉ** ูููุดุงุทุงุช

## ๐ ุฎุทูุงุช ุงูุฅุนุฏุงุฏ

### ุงูุฎุทูุฉ 1: ุฅูุดุงุก ุงูุฌุฏูู ูู Supabase

1. **ุงูุชุญ Supabase Dashboard**
   - ุงุฐูุจ ุฅูู [supabase.com](https://supabase.com)
   - ุงุฎุชุฑ ูุดุฑูุนู

2. **ุงูุชุญ SQL Editor**
   - ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉุ ุงุฎุชุฑ "SQL Editor"
   - ุงููุฑ ุนูู "New query"

3. **ุชูููุฐ ุณูุฑูุจุช ุฅูุดุงุก ุงูุฌุฏูู**
   - ุงูุณุฎ ูุญุชูู ููู `tracking-logs-table.sql`
   - ุงูุตู ุงูููุฏ ูู SQL Editor
   - ุงููุฑ ุนูู "Run" ูุชูููุฐ ุงูุณูุฑูุจุช

### ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู ุฅูุดุงุก ุงูุฌุฏูู

```sql
-- ุงูุชุญูู ูู ูุฌูุฏ ุงูุฌุฏูู
SELECT table_name, column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'tracking_logs'
ORDER BY ordinal_position;

-- ุงูุชุญูู ูู ุงูููุงุฑุณ
SELECT indexname, indexdef 
FROM pg_indexes 
WHERE tablename = 'tracking_logs';

-- ุงูุชุญูู ูู ุงูุณูุงุณุงุช ุงูุฃูููุฉ
SELECT policyname, permissive, roles, cmd, qual 
FROM pg_policies 
WHERE tablename = 'tracking_logs';
```

### ุงูุฎุทูุฉ 3: ุงุฎุชุจุงุฑ ุงูุฌุฏูู

```sql
-- ุฅุฏุฑุงุฌ ุณุฌู ุชุฌุฑูุจู
INSERT INTO tracking_logs (
    operation_type,
    unit_number,
    property_name,
    tenant_name,
    description
) VALUES (
    'ุงุฎุชุจุงุฑ ุงููุธุงู',
    'TEST-001',
    'ุนูุงุฑ ุชุฌุฑูุจู',
    'ูุณุชุฃุฌุฑ ุชุฌุฑูุจู',
    'ุณุฌู ุชุฌุฑูุจู ููุงุฎุชุจุงุฑ'
);

-- ูุฑุงุกุฉ ุงูุณุฌู
SELECT * FROM tracking_logs WHERE operation_type = 'ุงุฎุชุจุงุฑ ุงููุธุงู';

-- ุญุฐู ุงูุณุฌู ุงูุชุฌุฑูุจู
DELETE FROM tracking_logs WHERE operation_type = 'ุงุฎุชุจุงุฑ ุงููุธุงู';
```

## ๐ ูููู ุงูุฌุฏูู

### ุงูุฃุนูุฏุฉ ุงูุฑุฆูุณูุฉ:

| ุงูุนููุฏ | ุงูููุน | ุงููุตู |
|--------|-------|--------|
| `id` | UUID | ุงููุนุฑู ุงููุฑูุฏ ููุณุฌู |
| `operation_type` | TEXT | ููุน ุงูุนูููุฉ (ุชุญุฑูุฑุ ุนููู ุฌุฏูุฏุ ุฅูุฎ) |
| `timestamp` | TIMESTAMP | ููุช ุงูุนูููุฉ |
| `unit_number` | TEXT | ุฑูู ุงููุญุฏุฉ |
| `property_name` | TEXT | ุงุณู ุงูุนูุงุฑ |
| `tenant_name` | TEXT | ุงุณู ุงููุณุชุฃุฌุฑ |
| `tenant_phone` | TEXT | ุฑูู ุฌูุงู ุงููุณุชุฃุฌุฑ |
| `tenant_phone_2` | TEXT | ุฑูู ุฌูุงู ุฅุถุงูู |
| `changes` | JSONB | ุชูุงุตูู ุงูุชุบููุฑุงุช |
| `user_name` | TEXT | ุงุณู ุงููุณุชุฎุฏู |

### ุงูููุงุฑุณ ุงููุญุณูุฉ:

- `idx_tracking_logs_timestamp` - ููุจุญุซ ุจุงูุชุงุฑูุฎ
- `idx_tracking_logs_operation_type` - ููุจุญุซ ุจููุน ุงูุนูููุฉ
- `idx_tracking_logs_unit_property` - ููุจุญุซ ุจุงููุญุฏุฉ ูุงูุนูุงุฑ
- `idx_tracking_logs_search` - ููุจุญุซ ุงููุฑูุจ
- `idx_tracking_logs_changes_gin` - ููุจุญุซ ูู JSON

## ๐ง ุงูููุฒุงุช ุงููุชูุฏูุฉ

### 1. ุงูุฅุญุตุงุฆูุงุช ุงูุชููุงุฆูุฉ

```sql
-- ุงูุญุตูู ุนูู ุฅุญุตุงุฆูุงุช ุดุงููุฉ
SELECT * FROM get_tracking_logs_stats();
```

### 2. ุชูุธูู ุงูุณุฌูุงุช ุงููุฏููุฉ

```sql
-- ุญุฐู ุงูุณุฌูุงุช ุงูุฃูุฏู ูู ุณูุฉ
SELECT cleanup_old_tracking_logs(365);
```

### 3. ุนุฑุถ ุงูุณุฌูุงุช ุงูููุณูุฉ

```sql
-- ุงุณุชุฎุฏุงู ุงูู view ุงููุญุณู
SELECT * FROM tracking_logs_view 
WHERE operation_type = 'ุชุญุฑูุฑ ุจูุงูุงุช' 
ORDER BY timestamp DESC 
LIMIT 10;
```

## ๐ ุงูุชูุงูู ูุน ุงูุชุทุจูู

### ุงููููุงุช ุงููุญุฏุซุฉ:

1. **`tracking-logs-manager.js`** - ูุฏูุฑ ุงูุฌุฏูู ุงูุฌุฏูุฏ
2. **`script.js`** - ุชุญุฏูุซ ุงูุฏูุงู ุงูููุฌูุฏุฉ
3. **`index.html`** - ุฅุถุงูุฉ ุงููุฏูุฑ ุงูุฌุฏูุฏ
4. **`tracking-logs-table.sql`** - ุณูุฑูุจุช ุฅูุดุงุก ุงูุฌุฏูู

### ุงูุฏูุงู ุงูุฌุฏูุฏุฉ:

- `saveTrackingLogToSupabase()` - ุญูุธ ูู ุงูุฌุฏูู ุงูุฌุฏูุฏ
- `loadTrackingLogsFromSupabase()` - ุชุญููู ูู ุงูุฌุฏูู ุงูุฌุฏูุฏ
- `searchTrackingLogs()` - ุงูุจุญุซ ุงููุชูุฏู
- `getTrackingLogsStats()` - ุงูุฅุญุตุงุฆูุงุช
- `deleteTrackingLog()` - ุญุฐู ุณุฌู ูุญุฏุฏ

## ๐ก๏ธ ุงูุฃูุงู ูุงูุตูุงุญูุงุช

### ุณูุงุณุงุช RLS ุงููุทุจูุฉ:

- **ุงููุฑุงุกุฉ**: ูุณููุญุฉ ููุฌููุน
- **ุงูุฅุฏุฑุงุฌ**: ูุณููุญุฉ ููุฌููุน
- **ุงูุชุญุฏูุซ**: ูุณููุญุฉ ููุฌููุน
- **ุงูุญุฐู**: ูุณููุญุฉ ููุฌููุน (ูููุฏุฉ ูู ุงูุชุทุจูู)

### ุงูุชุญูู ูู ุงูุชุทุจูู:

- ุญุฐู ุงูุณุฌูุงุช ูููุฏ ูููุฏูุฑ ููุท
- ุชูุธูู ุงูุณุฌูุงุช ุงููุฏููุฉ ูููุฏูุฑ ููุท
- ุนุฑุถ ุงูุฅุญุตุงุฆูุงุช ููุฌููุน

## ๐ ุงููุฑุงูุจุฉ ูุงูุตูุงูุฉ

### ูุฑุงูุจุฉ ุงูุฃุฏุงุก:

```sql
-- ุญุฌู ุงูุฌุฏูู
SELECT 
    schemaname,
    tablename,
    attname,
    n_distinct,
    correlation
FROM pg_stats 
WHERE tablename = 'tracking_logs';

-- ุนุฏุฏ ุงูุณุฌูุงุช
SELECT COUNT(*) as total_logs FROM tracking_logs;

-- ุงูุณุฌูุงุช ุญุณุจ ุงูููุน
SELECT operation_type, COUNT(*) as count 
FROM tracking_logs 
GROUP BY operation_type 
ORDER BY count DESC;
```

### ุงูุตูุงูุฉ ุงูุฏูุฑูุฉ:

```sql
-- ุฅุนุงุฏุฉ ููุฑุณุฉ ุงูุฌุฏูู
REINDEX TABLE tracking_logs;

-- ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช
ANALYZE tracking_logs;

-- ุชูุธูู ุงูุณุฌูุงุช ุงููุฏููุฉ (ุดูุฑูุงู)
SELECT cleanup_old_tracking_logs(365);
```

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดุงูู ุงูุดุงุฆุนุฉ:

1. **ุงูุฌุฏูู ุบูุฑ ููุฌูุฏ**
   ```sql
   -- ุงูุชุญูู ูู ูุฌูุฏ ุงูุฌุฏูู
   SELECT EXISTS (
       SELECT FROM information_schema.tables 
       WHERE table_name = 'tracking_logs'
   );
   ```

2. **ูุดุงูู ุงูุตูุงุญูุงุช**
   ```sql
   -- ุงูุชุญูู ูู ุณูุงุณุงุช RLS
   SELECT * FROM pg_policies WHERE tablename = 'tracking_logs';
   ```

3. **ุจุทุก ูู ุงูุฃุฏุงุก**
   ```sql
   -- ุงูุชุญูู ูู ุงุณุชุฎุฏุงู ุงูููุงุฑุณ
   EXPLAIN ANALYZE SELECT * FROM tracking_logs 
   WHERE operation_type = 'ุชุญุฑูุฑ ุจูุงูุงุช' 
   ORDER BY timestamp DESC;
   ```

## โ ูุงุฆูุฉ ุงูุชุญูู

- [ ] ุชู ุฅูุดุงุก ุงูุฌุฏูู ุจูุฌุงุญ
- [ ] ุชู ุฅูุดุงุก ุฌููุน ุงูููุงุฑุณ
- [ ] ุชู ุชุทุจูู ุณูุงุณุงุช RLS
- [ ] ุชู ุงุฎุชุจุงุฑ ุงูุฅุฏุฑุงุฌ ูุงููุฑุงุกุฉ
- [ ] ุชู ุชุญุฏูุซ ูููุงุช ุงูุชุทุจูู
- [ ] ุชู ุงุฎุชุจุงุฑ ุงููุงุฌูุฉ ุงูุฌุฏูุฏุฉ
- [ ] ุชู ุงูุชุญูู ูู ุงูุฅุญุตุงุฆูุงุช
- [ ] ุชู ุงุฎุชุจุงุฑ ุญุฐู ุงูุณุฌูุงุช

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

ุจุนุฏ ุฅููุงู ุงูุฅุนุฏุงุฏุ ุณุชุญุตู ุนูู:

- โ **ุฌุฏูู ูุฎุตุต** ูุณุฌูุงุช ุงูุชุชุจุน ูููุตู ุชูุงูุงู
- โ **ูุดุงุฑูุฉ ููุฑูุฉ** ููุณุฌูุงุช ุจูู ุฌููุน ุงููุณุชุฎุฏููู
- โ **ุฃุฏุงุก ูุญุณู** ูุน ููุฑุณุฉ ูุชูุฏูุฉ
- โ **ุฅุญุตุงุฆูุงุช ุดุงููุฉ** ูููุดุงุทุงุช
- โ **ุจุญุซ ูุชูุฏู** ูุชุตููุฉ ูุฑูุฉ
- โ **ุตูุงูุฉ ุชููุงุฆูุฉ** ููุณุฌูุงุช ุงููุฏููุฉ
- โ **ุฃูุงู ูุญุณู** ูุน ุณูุงุณุงุช RLS

---

**ููุงุญุธุฉ**: ุชุฃูุฏ ูู ุนูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุจู ุชูููุฐ ุฃู ุชุบููุฑุงุช!
