<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</title>
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            margin: 20px;
            background: #f8f9fa;
            direction: rtl;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        .info {
            color: #17a2b8;
            font-weight: bold;
        }
        .warning {
            color: #ffc107;
            font-weight: bold;
        }
        .status-display {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
        }
        .header-simulation {
            background: #343a40;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logout-btn-sim {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”‘ Ø§Ø®ØªØ¨Ø§Ø± Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</h1>
        
        <div class="test-section">
            <h3>ğŸ“‹ ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©</h3>
            <p><strong>Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:</strong> Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù„Ø§ ÙŠØ¸Ù‡Ø± Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©ØŒ ÙˆÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ reload Ù„ÙŠØ¸Ù‡Ø±.</p>
            <p><strong>Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ø·Ø¨Ù‚:</strong> Ø¥Ø¶Ø§ÙØ© Ø¹Ø¯Ø© Ù†Ù‚Ø§Ø· ØªØ­Ù‚Ù‚ ÙˆØ§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© Ù„Ø¶Ù…Ø§Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø²Ø±.</p>
        </div>

        <div class="test-section">
            <h3>ğŸ”§ Ø§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©</h3>
            <ul>
                <li>âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ù…Ø¨ÙƒØ± ÙÙŠ <code>DOMContentLoaded</code></li>
                <li>âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙÙŠ <code>initializeApp</code></li>
                <li>âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙÙŠ <code>setCurrentUser</code></li>
                <li>âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙÙŠ <code>handleLogin</code></li>
                <li>âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙÙŠ <code>initializePermissionSystem</code></li>
                <li>âœ… Ø¥Ø¶Ø§ÙØ© Ù…Ø±Ø§Ù‚Ø¨ DOM Ù„Ù„ØªØ­Ù‚Ù‚ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</li>
                <li>âœ… Ø¥Ø¶Ø§ÙØ© Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ø¹ ØªØ£Ø®ÙŠØ±</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
            
            <button class="test-button" onclick="testHeaderExists()">ğŸ” ÙØ­Øµ ÙˆØ¬ÙˆØ¯ Header</button>
            <button class="test-button" onclick="testLogoutButtonExists()">ğŸ”‘ ÙØ­Øµ ÙˆØ¬ÙˆØ¯ Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            <button class="test-button" onclick="testCurrentUser()">ğŸ‘¤ ÙØ­Øµ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ</button>
            <button class="test-button" onclick="simulateLogin()">ğŸ” Ù…Ø­Ø§ÙƒØ§Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
            <button class="test-button" onclick="forceAddLogoutButton()">âš¡ Ø¥Ø¬Ø¨Ø§Ø± Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø²Ø±</button>
            <button class="test-button" onclick="openMainApp()">ğŸ  ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</button>
            
            <div id="testResults"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ“Š Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
            <div id="systemStatus" class="status-display">Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ù†Ø¸Ø§Ù…...</div>
            <button class="test-button" onclick="refreshSystemStatus()">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©</button>
        </div>

        <div class="test-section">
            <h3>ğŸ¯ Ù…Ø­Ø§ÙƒØ§Ø© Header</h3>
            <div class="header-simulation">
                <div>ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª</div>
                <div id="simulatedLogoutArea">
                    <span style="color: #ffc107;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</span>
                </div>
            </div>
            <button class="test-button" onclick="addSimulatedLogoutButton()">â• Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ù…Ø­Ø§ÙƒÙŠ</button>
            <button class="test-button" onclick="removeSimulatedLogoutButton()">â– Ø¥Ø²Ø§Ù„Ø© Ø²Ø± Ù…Ø­Ø§ÙƒÙŠ</button>
        </div>

        <div class="test-section">
            <h3>ğŸ“ Ù†ØµØ§Ø¦Ø­ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
            <ol>
                <li>Ø§ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯</li>
                <li>Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø¨Ø£ÙŠ Ù…Ø³ØªØ®Ø¯Ù…</li>
                <li>ØªØ­Ù‚Ù‚ Ù…Ù† Ø¸Ù‡ÙˆØ± Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ÙÙˆØ±Ø§Ù‹</li>
                <li>Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¸Ù‡Ø±ØŒ Ø§ÙØªØ­ Developer Tools ÙˆØªØ­Ù‚Ù‚ Ù…Ù† Console</li>
                <li>Ø§Ø¨Ø­Ø« Ø¹Ù† Ø±Ø³Ø§Ø¦Ù„ "ğŸ”‘ Ø¥Ø¶Ø§ÙØ© Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬"</li>
            </ol>
        </div>
    </div>

    <script>
        function log(message, type = 'info') {
            const results = document.getElementById('testResults');
            const div = document.createElement('div');
            div.className = type;
            div.textContent = `${new Date().toLocaleTimeString()} - ${message}`;
            results.appendChild(div);
            results.scrollTop = results.scrollHeight;
        }

        function testHeaderExists() {
            // Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Ù†Ø§ÙØ°Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Header
            const testWindow = window.open('index.html', '_blank', 'width=800,height=600');
            
            setTimeout(() => {
                try {
                    const header = testWindow.document.querySelector('.header-section.header-actions');
                    if (header) {
                        log('âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Header ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'success');
                    } else {
                        log('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Header ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'error');
                    }
                    testWindow.close();
                } catch (error) {
                    log('âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (CORS)', 'warning');
                    testWindow.close();
                }
            }, 2000);
        }

        function testLogoutButtonExists() {
            log('ğŸ” ÙØ­Øµ ÙˆØ¬ÙˆØ¯ Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ...', 'info');
            log('ğŸ’¡ ÙŠØ±Ø¬Ù‰ ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ù„Ù„ØªØ­Ù‚Ù‚', 'info');
        }

        function testCurrentUser() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                try {
                    const userData = JSON.parse(savedUser);
                    log(`ğŸ‘¤ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø­ÙÙˆØ¸: ${userData.username}`, 'success');
                } catch (error) {
                    log('âŒ Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©', 'error');
                }
            } else {
                log('ğŸ‘¤ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø­ÙÙˆØ¸', 'warning');
            }
        }

        function simulateLogin() {
            const userData = {
                username: 'test_user',
                loginTime: new Date().toISOString()
            };
            localStorage.setItem('currentUser', JSON.stringify(userData));
            log('âœ… ØªÙ… Ù…Ø­Ø§ÙƒØ§Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„', 'success');
            log('ğŸ’¡ Ø§Ù„Ø¢Ù† Ø§ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¸Ù‡ÙˆØ± Ø§Ù„Ø²Ø±', 'info');
        }

        function forceAddLogoutButton() {
            log('âš¡ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø¬Ø¨Ø§Ø± Ø¥Ø¶Ø§ÙØ© Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬...', 'info');
            log('ğŸ’¡ Ù‡Ø°Ø§ ÙŠØ¹Ù…Ù„ ÙÙ‚Ø· ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'warning');
        }

        function openMainApp() {
            window.open('index.html', '_blank');
            log('ğŸ  ØªÙ… ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯', 'info');
        }

        function refreshSystemStatus() {
            const statusDiv = document.getElementById('systemStatus');
            const savedUser = localStorage.getItem('currentUser');
            
            let status = '';
            status += `ğŸ“… Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ: ${new Date().toLocaleString()}\n`;
            status += `ğŸ’¾ localStorage Ù…ØªØ§Ø­: ${localStorage ? 'âœ…' : 'âŒ'}\n`;
            status += `ğŸ‘¤ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø­ÙÙˆØ¸: ${savedUser ? 'âœ…' : 'âŒ'}\n`;
            
            if (savedUser) {
                try {
                    const userData = JSON.parse(savedUser);
                    status += `ğŸ“ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${userData.username}\n`;
                    status += `â° ÙˆÙ‚Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: ${new Date(userData.loginTime).toLocaleString()}\n`;
                } catch (error) {
                    status += `âŒ Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…\n`;
                }
            }
            
            status += `ğŸŒ Ø§Ù„Ù…ØªØµÙØ­: ${navigator.userAgent.split(' ')[0]}\n`;
            status += `ğŸ“± Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²: ${window.innerWidth <= 768 ? 'Ø¬ÙˆØ§Ù„' : 'Ø³Ø·Ø­ Ù…ÙƒØªØ¨'}\n`;
            
            statusDiv.textContent = status;
        }

        function addSimulatedLogoutButton() {
            const area = document.getElementById('simulatedLogoutArea');
            area.innerHTML = '<button class="logout-btn-sim" onclick="alert(\'ØªÙ… Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ù…Ø­Ø§ÙƒÙŠ\')">ğŸ”‘ Ø®Ø±ÙˆØ¬ (Ù…Ø³ØªØ®Ø¯Ù… ØªØ¬Ø±ÙŠØ¨ÙŠ)</button>';
            log('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ù…Ø­Ø§ÙƒÙŠ', 'success');
        }

        function removeSimulatedLogoutButton() {
            const area = document.getElementById('simulatedLogoutArea');
            area.innerHTML = '<span style="color: #ffc107;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</span>';
            log('ğŸ—‘ï¸ ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ù…Ø­Ø§ÙƒÙŠ', 'info');
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            log('ğŸš€ ØªÙ… ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', 'success');
            refreshSystemStatus();
        });
    </script>
</body>
</html>
