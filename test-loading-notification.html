<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار إشعار التحميل</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: 0 auto;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            font-size: 14px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-button.danger {
            background: #dc3545;
        }
        .test-button.danger:hover {
            background: #c82333;
        }
        .test-button.success {
            background: #28a745;
        }
        .test-button.success:hover {
            background: #218838;
        }
        .log-container {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        .header-simulation {
            background: #343a40;
            color: white;
            padding: 10px 20px;
            margin: -20px -20px 20px -20px;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="header-simulation">
            محاكاة الهيدر - الإشعار سيظهر في يسار هذا المكان
        </div>
        
        <h2>🧪 اختبار إشعار التحميل</h2>
        
        <div class="test-buttons">
            <button class="test-button" onclick="testShowNotification()">
                🔄 عرض الإشعار
            </button>
            
            <button class="test-button danger" onclick="testHideNotification()">
                ❌ إخفاء الإشعار
            </button>
            
            <button class="test-button success" onclick="simulateSync()">
                ✅ محاكاة المزامنة
            </button>
            
            <button class="test-button" onclick="testDelayedHide()">
                ⏱️ إخفاء مؤجل (3 ثوان)
            </button>

            <button class="test-button" onclick="clearLog()">
                🧹 مسح السجل
            </button>
        </div>
        
        <div class="log-container" id="logContainer">
            <div>📋 سجل الاختبار:</div>
        </div>
    </div>

    <script>
        // دالة إشعار تحميل المحتوى
        function showContentLoadingNotification() {
            try {
                log('🔄 عرض إشعار تحميل المحتوى...');
                
                // التحقق من وجود إشعار سابق وحذفه
                const existingNotification = document.getElementById('contentLoadingNotification');
                if (existingNotification) {
                    existingNotification.remove();
                    log('🗑️ تم حذف الإشعار السابق');
                }
                
                // إنشاء إشعار صغير في يسار الهيدر
                const notification = document.createElement('div');
                notification.id = 'contentLoadingNotification';
                notification.style.cssText = `
                    position: fixed !important;
                    top: 15px !important;
                    left: 20px !important;
                    background: #17a2b8 !important;
                    color: white !important;
                    padding: 8px 12px !important;
                    border-radius: 6px !important;
                    font-size: 12px !important;
                    font-weight: 500 !important;
                    z-index: 99999 !important;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
                    display: flex !important;
                    align-items: center !important;
                    gap: 6px !important;
                    opacity: 0 !important;
                    transform: translateX(-100%) !important;
                    transition: all 0.3s ease-out !important;
                    max-width: 180px !important;
                    font-family: Arial, sans-serif !important;
                `;
                
                notification.innerHTML = `
                    <span style="display: inline-block; width: 12px; height: 12px; border: 2px solid rgba(255,255,255,0.3); border-top: 2px solid white; border-radius: 50%; animation: spin 1s linear infinite;"></span>
                    جاري تحميل المحتوى
                `;
                
                // إضافة CSS للدوران
                if (!document.getElementById('loadingSpinCSS')) {
                    const style = document.createElement('style');
                    style.id = 'loadingSpinCSS';
                    style.textContent = `
                        @keyframes spin {
                            0% { transform: rotate(0deg); }
                            100% { transform: rotate(360deg); }
                        }
                    `;
                    document.head.appendChild(style);
                }
                
                document.body.appendChild(notification);
                log('📍 تم إضافة الإشعار إلى الصفحة');
                
                // تأثير الظهور السلس
                setTimeout(() => {
                    if (notification && notification.parentNode) {
                        notification.style.opacity = '1';
                        notification.style.transform = 'translateX(0)';
                        log('✨ تم تطبيق تأثير الظهور');
                    }
                }, 100);
                
                log('✅ تم عرض إشعار تحميل المحتوى في يسار الهيدر');
                
            } catch (error) {
                log('❌ خطأ في عرض إشعار التحميل: ' + error.message, 'error');
            }
        }

        function hideContentLoadingNotification(delay = 0) {
            try {
                log(`✅ إخفاء إشعار تحميل المحتوى بعد ${delay}ms...`);

                // إلغاء المؤقت التلقائي إذا كان موجوداً
                if (window.contentLoadingTimeout) {
                    clearTimeout(window.contentLoadingTimeout);
                    window.contentLoadingTimeout = null;
                    log('⏰ تم إلغاء المؤقت التلقائي');
                }

                setTimeout(() => {
                    const notification = document.getElementById('contentLoadingNotification');
                    if (notification && notification.parentNode) {
                        // تأثير الاختفاء السلس
                        notification.style.opacity = '0';
                        notification.style.transform = 'translateX(-100%)';

                        // إزالة العنصر بعد انتهاء التأثير
                        setTimeout(() => {
                            if (notification && notification.parentNode) {
                                notification.parentNode.removeChild(notification);
                                log('🗑️ تم حذف الإشعار من الصفحة');
                            }
                        }, 300);

                        log('✅ تم إخفاء إشعار تحميل المحتوى بسلاسة');
                    } else {
                        log('ℹ️ لا يوجد إشعار تحميل لإخفائه');
                    }
                }, delay);

            } catch (error) {
                log('❌ خطأ في إخفاء إشعار التحميل: ' + error.message, 'error');
            }
        }

        // دوال الاختبار
        function testShowNotification() {
            log('🧪 اختبار عرض الإشعار...');
            showContentLoadingNotification();
        }

        function testHideNotification() {
            log('🧪 اختبار إخفاء الإشعار فوراً...');
            hideContentLoadingNotification();
        }

        function testDelayedHide() {
            log('🧪 اختبار إخفاء الإشعار بعد 3 ثوانٍ...');
            hideContentLoadingNotification(3000);
        }

        function simulateSync() {
            log('🧪 محاكاة المزامنة...');
            showContentLoadingNotification();

            setTimeout(() => {
                log('🔔 محاكاة إشعار "المزامنة الفورية نشطة"');
                log('⏱️ الإشعار سيختفي بعد 5 ثوانٍ من ظهور إشعار المزامنة');
                hideContentLoadingNotification(5000);
            }, 3000);
        }

        function log(message, type = 'info') {
            const logContainer = document.getElementById('logContainer');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#ff6b6b' : type === 'success' ? '#51cf66' : '#74c0fc';
            
            logContainer.innerHTML += `<div style="color: ${color};">[${timestamp}] ${message}</div>`;
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function clearLog() {
            document.getElementById('logContainer').innerHTML = '<div>📋 سجل الاختبار:</div>';
        }

        // اختبار تلقائي عند تحميل الصفحة
        window.addEventListener('load', () => {
            log('🚀 تم تحميل صفحة الاختبار');
            log('💡 اضغط على "عرض الإشعار" لاختبار الميزة');
        });
    </script>
</body>
</html>
