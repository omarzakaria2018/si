<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงุฎุชุจุงุฑ ุฅุฎูุงุก ุงูุฃุฒุฑุงุฑ ุนู ุงููุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ</title>
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            margin: 20px;
            background: #f8f9fa;
            direction: rtl;
        }
        .test-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .limited-button {
            background: #ffc107;
            color: #212529;
        }
        .limited-button:hover {
            background: #e0a800;
        }
        .admin-button {
            background: #28a745;
        }
        .admin-button:hover {
            background: #218838;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        .info {
            color: #17a2b8;
            font-weight: bold;
        }
        .warning {
            color: #ffc107;
            font-weight: bold;
        }
        .results-display {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .demo-buttons {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .demo-button {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            margin: 5px;
            cursor: pointer;
        }
        .admin-only-feature {
            display: block !important;
        }
        body.limited-user .admin-only-feature {
            display: none !important;
        }
        .user-status {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
        }
        .user-status.limited {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>๐ ุงุฎุชุจุงุฑ ุฅุฎูุงุก ุงูุฃุฒุฑุงุฑ ุนู ุงููุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ</h1>
        
        <div class="test-section">
            <h3>๐ ูุตู ุงูููุฒุฉ</h3>
            <p><strong>ุงููุฏู:</strong> ุฅุฎูุงุก ุงูุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑูุฉ ุนู ุงููุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ ูู ุฌููุน ุงูุดุงุดุงุช.</p>
            <p><strong>ุงูุฃุฒุฑุงุฑ ุงููุฎููุฉ:</strong></p>
            <ul>
                <li>๐ข ุฅุฏุงุฑุฉ ุงูุนูุงุฑุงุช</li>
                <li>๐ ุชุญุฏูุซ ุงูุชูุงุฑูุฎ</li>
                <li>๐ ุฅุตูุงุญ ุงูุฅุญุตุงุฆูุงุช</li>
                <li>๐ ุฅุนุงุฏุฉ ุชุนููู ุงูุญุงูุฉ</li>
            </ul>
        </div>

        <div id="userStatus" class="user-status">
            ุญุงูุฉ ุงููุณุชุฎุฏู: ุบูุฑ ูุญุฏุฏ
        </div>

        <div class="test-section">
            <h3>๐งช ุงุฎุชุจุงุฑ ุชุจุฏูู ุงููุณุชุฎุฏู</h3>
            
            <button class="test-button admin-button" onclick="simulateAdminUser()">๐จโ๐ผ ูุญุงูุงุฉ ูุณุชุฎุฏู ุฅุฏุงุฑู</button>
            <button class="test-button limited-button" onclick="simulateLimitedUser()">๐ค ูุญุงูุงุฉ ูุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ</button>
            <button class="test-button" onclick="resetUserMode()">๐ ุฅุนุงุฏุฉ ุชุนููู</button>
            <button class="test-button" onclick="openMainApp()">๐ ูุชุญ ุงูุชุทุจูู ุงูุฑุฆูุณู</button>
            <button class="test-button" onclick="testRealApp()">๐งช ุงุฎุชุจุงุฑ ุงูุชุทุจูู ุงูุญูููู</button>
            
            <div id="testResults" class="results-display">ุฌุงุฑู ุชุญููู ุฃุฏูุงุช ุงูุงุฎุชุจุงุฑ...</div>
        </div>

        <div class="test-section">
            <h3>๐ฏ ูุญุงูุงุฉ ุงูุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑูุฉ</h3>
            <div class="demo-buttons">
                <h4>ุงูุฃุฒุฑุงุฑ ูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ:</h4>
                
                <button class="demo-button admin-only-feature">
                    <i class="fas fa-building"></i> ุฅุฏุงุฑุฉ ุงูุนูุงุฑุงุช
                </button>
                
                <button class="demo-button admin-only-feature">
                    <i class="fas fa-calendar-alt"></i> ุชุญุฏูุซ ุงูุชูุงุฑูุฎ
                </button>
                
                <button class="demo-button admin-only-feature">
                    <i class="fas fa-calculator"></i> ุฅุตูุงุญ ุงูุฅุญุตุงุฆูุงุช
                </button>
                
                <button class="demo-button admin-only-feature">
                    <i class="fas fa-refresh"></i> ุฅุนุงุฏุฉ ุชุนููู ุงูุญุงูุฉ
                </button>
                
                <button class="demo-button">
                    <i class="fas fa-eye"></i> ุนุฑุถ ุงูุจูุงูุงุช (ูุฑุฆู ููุฌููุน)
                </button>
                
                <button class="demo-button">
                    <i class="fas fa-download"></i> ุชุตุฏูุฑ Excel (ูุฑุฆู ููุฌููุน)
                </button>
            </div>
            
            <h4>ุงูุฃุฒุฑุงุฑ ูู ูุงุฆูุฉ ุงูุฌูุงู:</h4>
            <div class="demo-buttons">
                <button class="demo-button admin-only-feature">
                    <i class="fas fa-building"></i> ุฅุฏุงุฑุฉ ุงูุนูุงุฑุงุช (ุฌูุงู)
                </button>
                
                <button class="demo-button admin-only-feature">
                    <i class="fas fa-calendar-edit"></i> ุชุญุฏูุซ ุงูุชูุงุฑูุฎ (ุฌูุงู)
                </button>
                
                <button class="demo-button admin-only-feature">
                    <i class="fas fa-calculator"></i> ุฅุตูุงุญ ุงูุฅุญุตุงุฆูุงุช (ุฌูุงู)
                </button>
                
                <button class="demo-button admin-only-feature">
                    <i class="fas fa-refresh"></i> ุฅุนุงุฏุฉ ุชุนููู ุงูุญุงูุฉ (ุฌูุงู)
                </button>
                
                <button class="demo-button">
                    <i class="fas fa-search"></i> ุงูุจุญุซ (ูุฑุฆู ููุฌููุน)
                </button>
            </div>
        </div>

        <div class="test-section">
            <h3>๐ ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑ</h3>
            <button class="test-button" onclick="testButtonVisibility()">๐ ูุญุต ุธููุฑ ุงูุฃุฒุฑุงุฑ</button>
            <button class="test-button" onclick="countVisibleButtons()">๐ ุนุฏ ุงูุฃุฒุฑุงุฑ ุงููุฑุฆูุฉ</button>
            <button class="test-button" onclick="testUserPermissions()">๐ ุงุฎุชุจุงุฑ ุงูุตูุงุญูุงุช</button>
            <div id="testSummary" class="results-display">ุงุถุบุท ุนูู "ูุญุต ุธููุฑ ุงูุฃุฒุฑุงุฑ" ูุฑุคูุฉ ุงููุชุงุฆุฌ</div>
        </div>

        <div class="test-section">
            <h3>๐ ุชุนูููุงุช ุงูุงุฎุชุจุงุฑ</h3>
            <ol>
                <li><strong>ุงุฎุชุจุงุฑ ุงููุณุชุฎุฏู ุงูุฅุฏุงุฑู:</strong>
                    <ul>
                        <li>ุงุถุบุท "ูุญุงูุงุฉ ูุณุชุฎุฏู ุฅุฏุงุฑู"</li>
                        <li>ูุฌุจ ุฃู ุชุธูุฑ ุฌููุน ุงูุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑูุฉ โ</li>
                    </ul>
                </li>
                <li><strong>ุงุฎุชุจุงุฑ ุงููุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ:</strong>
                    <ul>
                        <li>ุงุถุบุท "ูุญุงูุงุฉ ูุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ"</li>
                        <li>ูุฌุจ ุฃู ุชุฎุชูู ุงูุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑูุฉ ุงูุฃุฑุจุนุฉ โ</li>
                        <li>ูุฌุจ ุฃู ุชุจูู ุงูุฃุฒุฑุงุฑ ุงูุนุงูุฉ ูุฑุฆูุฉ โ</li>
                    </ul>
                </li>
                <li><strong>ุงุฎุชุจุงุฑ ุงูุชุทุจูู ุงูุฑุฆูุณู:</strong>
                    <ul>
                        <li>ุงูุชุญ ุงูุชุทุจูู ุงูุฑุฆูุณู</li>
                        <li>ุณุฌู ุฏุฎูู ุจูุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ (sa12345)</li>
                        <li>ุชุญูู ูู ุงุฎุชูุงุก ุงูุฃุฒุฑุงุฑ ูู ุฌููุน ุงูุดุงุดุงุช</li>
                    </ul>
                </li>
            </ol>
        </div>
    </div>

    <script>
        function log(message, type = 'info') {
            const results = document.getElementById('testResults');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}\n`;
            results.textContent += logEntry;
            results.scrollTop = results.scrollHeight;
        }

        function updateUserStatus(userType, description) {
            const statusDiv = document.getElementById('userStatus');
            statusDiv.textContent = `ุญุงูุฉ ุงููุณุชุฎุฏู: ${description}`;
            
            if (userType === 'limited') {
                statusDiv.className = 'user-status limited';
            } else {
                statusDiv.className = 'user-status';
            }
        }

        function simulateAdminUser() {
            document.body.classList.remove('limited-user');
            updateUserStatus('admin', 'ูุณุชุฎุฏู ุฅุฏุงุฑู (ุฌููุน ุงูุฃุฒุฑุงุฑ ูุฑุฆูุฉ)');
            log('๐จโ๐ผ ุชู ุชูุนูู ูุถุน ุงููุณุชุฎุฏู ุงูุฅุฏุงุฑู', 'success');
            log('โ ูุฌุจ ุฃู ุชุธูุฑ ุฌููุน ุงูุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑูุฉ ุงูุขู', 'info');
        }

        function simulateLimitedUser() {
            document.body.classList.add('limited-user');
            updateUserStatus('limited', 'ูุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ (ุงูุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑูุฉ ูุฎููุฉ)');
            log('๐ค ุชู ุชูุนูู ูุถุน ุงููุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ', 'warning');
            log('๐ ูุฌุจ ุฃู ุชุฎุชูู ุงูุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑูุฉ ุงูุฃุฑุจุนุฉ ุงูุขู', 'info');
        }

        function resetUserMode() {
            document.body.classList.remove('limited-user');
            updateUserStatus('reset', 'ุชู ุฅุนุงุฏุฉ ุงูุชุนููู');
            log('๐ ุชู ุฅุนุงุฏุฉ ุชุนููู ูุถุน ุงููุณุชุฎุฏู', 'info');
        }

        function testButtonVisibility() {
            const adminButtons = document.querySelectorAll('.admin-only-feature');
            const isLimitedUser = document.body.classList.contains('limited-user');
            
            log('๐ ูุญุต ุธููุฑ ุงูุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑูุฉ...', 'info');
            log(`๐ค ูุถุน ุงููุณุชุฎุฏู: ${isLimitedUser ? 'ูุญุฏูุฏ ุงูุตูุงุญูุฉ' : 'ุฅุฏุงุฑู'}`, 'info');
            log(`๐ ุนุฏุฏ ุงูุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑูุฉ: ${adminButtons.length}`, 'info');
            
            let visibleCount = 0;
            let hiddenCount = 0;
            
            adminButtons.forEach((button, index) => {
                const isVisible = window.getComputedStyle(button).display !== 'none';
                const buttonText = button.textContent.trim();
                
                if (isVisible) {
                    visibleCount++;
                    log(`โ ุงูุฒุฑ ${index + 1}: "${buttonText}" - ูุฑุฆู`, isLimitedUser ? 'error' : 'success');
                } else {
                    hiddenCount++;
                    log(`โ ุงูุฒุฑ ${index + 1}: "${buttonText}" - ูุฎูู`, isLimitedUser ? 'success' : 'error');
                }
            });
            
            log(`๐ ุงููุชูุฌุฉ: ${visibleCount} ูุฑุฆูุ ${hiddenCount} ูุฎูู`, 'info');
            
            if (isLimitedUser && hiddenCount === adminButtons.length) {
                log('๐ ููุชุงุฒ! ุฌููุน ุงูุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑูุฉ ูุฎููุฉ ูููุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ', 'success');
            } else if (!isLimitedUser && visibleCount === adminButtons.length) {
                log('๐ ููุชุงุฒ! ุฌููุน ุงูุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑูุฉ ูุฑุฆูุฉ ูููุณุชุฎุฏู ุงูุฅุฏุงุฑู', 'success');
            } else {
                log('โ๏ธ ููุงู ูุดููุฉ ูู ุฅุธูุงุฑ/ุฅุฎูุงุก ุงูุฃุฒุฑุงุฑ', 'error');
            }
        }

        function countVisibleButtons() {
            const allButtons = document.querySelectorAll('.demo-button');
            const adminButtons = document.querySelectorAll('.admin-only-feature');
            const regularButtons = Array.from(allButtons).filter(btn => !btn.classList.contains('admin-only-feature'));
            
            let visibleAdmin = 0;
            let visibleRegular = 0;
            
            adminButtons.forEach(btn => {
                if (window.getComputedStyle(btn).display !== 'none') {
                    visibleAdmin++;
                }
            });
            
            regularButtons.forEach(btn => {
                if (window.getComputedStyle(btn).display !== 'none') {
                    visibleRegular++;
                }
            });
            
            const summary = document.getElementById('testSummary');
            summary.textContent = `๐ ุฅุญุตุงุฆูุงุช ุงูุฃุฒุฑุงุฑ:\n\n` +
                `๐ง ุงูุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑูุฉ: ${visibleAdmin}/${adminButtons.length} ูุฑุฆูุฉ\n` +
                `๐๏ธ ุงูุฃุฒุฑุงุฑ ุงูุนุงูุฉ: ${visibleRegular}/${regularButtons.length} ูุฑุฆูุฉ\n` +
                `๐ฑ ุฅุฌูุงูู ุงูุฃุฒุฑุงุฑ: ${visibleAdmin + visibleRegular}/${allButtons.length} ูุฑุฆูุฉ\n\n` +
                `ุงูุญุงูุฉ: ${document.body.classList.contains('limited-user') ? 'ูุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ' : 'ูุณุชุฎุฏู ุฅุฏุงุฑู'}`;
        }

        function testUserPermissions() {
            const isLimitedUser = document.body.classList.contains('limited-user');
            
            log('๐ ุงุฎุชุจุงุฑ ุตูุงุญูุงุช ุงููุณุชุฎุฏู...', 'info');
            
            const permissions = {
                'ุฅุฏุงุฑุฉ ุงูุนูุงุฑุงุช': !isLimitedUser,
                'ุชุญุฏูุซ ุงูุชูุงุฑูุฎ': !isLimitedUser,
                'ุฅุตูุงุญ ุงูุฅุญุตุงุฆูุงุช': !isLimitedUser,
                'ุฅุนุงุฏุฉ ุชุนููู ุงูุญุงูุฉ': !isLimitedUser,
                'ุนุฑุถ ุงูุจูุงูุงุช': true,
                'ุชุตุฏูุฑ Excel': true
            };
            
            Object.entries(permissions).forEach(([action, allowed]) => {
                const status = allowed ? 'โ ูุณููุญ' : 'โ ููููุน';
                log(`${action}: ${status}`, allowed ? 'success' : 'warning');
            });
        }

        function openMainApp() {
            window.open('index.html', '_blank');
            log('๐ ุชู ูุชุญ ุงูุชุทุจูู ุงูุฑุฆูุณู ูู ุชุจููุจ ุฌุฏูุฏ', 'info');
            log('๐ก ุณุฌู ุฏุฎูู ุจู sa12345 ูุงุฎุชุจุงุฑ ุงููุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ', 'info');
            log('๐ ุงุจุญุซ ุนู ุงูุฃุฒุฑุงุฑ ุงูุชุงููุฉ - ูุฌุจ ุฃู ุชููู ูุฎููุฉ:', 'info');
            log('   - ุฅุฏุงุฑุฉ ุงูุนูุงุฑุงุช', 'info');
            log('   - ุชุญุฏูุซ ุงูุชูุงุฑูุฎ', 'info');
            log('   - ุฅุตูุงุญ ุงูุฅุญุตุงุฆูุงุช', 'info');
            log('   - ุฅุนุงุฏุฉ ุชุนููู ุงูุญุงูุฉ', 'info');
        }

        function testRealApp() {
            log('๐งช ุงุฎุชุจุงุฑ ุงูุชุทุจูู ุงูุญูููู...', 'info');

            // ูุญุงููุฉ ุงููุตูู ููุชุทุจูู ุงูุฑุฆูุณู
            const testWindow = window.open('index.html', '_blank', 'width=1200,height=800');

            setTimeout(() => {
                try {
                    // ูุญุงููุฉ ุชุทุจูู ุงููุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ
                    if (testWindow.setCurrentUser && testWindow.users) {
                        testWindow.setCurrentUser('sa12345');
                        log('โ ุชู ุชุทุจูู ุงููุณุชุฎุฏู ูุญุฏูุฏ ุงูุตูุงุญูุฉ ูู ุงูุชุทุจูู', 'success');

                        setTimeout(() => {
                            // ูุญุต ุงูุฃุฒุฑุงุฑ
                            const adminButtons = testWindow.document.querySelectorAll('.admin-only-feature');
                            log(`๐ ุชู ุงูุนุซูุฑ ุนูู ${adminButtons.length} ุฒุฑ ุฅุฏุงุฑู`, 'info');

                            let hiddenCount = 0;
                            adminButtons.forEach(btn => {
                                const isHidden = testWindow.getComputedStyle(btn).display === 'none';
                                if (isHidden) hiddenCount++;
                            });

                            log(`๐ ${hiddenCount}/${adminButtons.length} ุฒุฑ ูุฎูู`, hiddenCount === adminButtons.length ? 'success' : 'error');

                        }, 2000);
                    } else {
                        log('โ๏ธ ูุง ูููู ุงููุตูู ููุธุงุฆู ุงูุชุทุจูู ุงูุฑุฆูุณู', 'warning');
                    }
                } catch (error) {
                    log('โ๏ธ ูุง ูููู ุงููุตูู ููุชุทุจูู ุงูุฑุฆูุณู (CORS)', 'warning');
                }
            }, 3000);
        }

        // ุชุญููู ุงูุตูุญุฉ
        document.addEventListener('DOMContentLoaded', function() {
            log('๐ ุชู ุชุญููู ุฃุฏูุงุช ุงุฎุชุจุงุฑ ุฅุฎูุงุก ุงูุฃุฒุฑุงุฑ', 'success');
            log('๐ก ุงุณุชุฎุฏู ุงูุฃุฒุฑุงุฑ ุฃุนูุงู ูุงุฎุชุจุงุฑ ุฅุฎูุงุก ุงูุฃุฒุฑุงุฑ ุงูุฅุฏุงุฑูุฉ', 'info');
            updateUserStatus('default', 'ุงูุชุฑุงุถู (ุฌููุน ุงูุฃุฒุฑุงุฑ ูุฑุฆูุฉ)');
        });
    </script>
</body>
</html>
