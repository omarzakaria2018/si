<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงุฎุชุจุงุฑ ุฅุตูุงุญ ุงูุจุญุซ ุงููุฑูู</title>
    <style>
        body {
            font-family: 'Cairo', 'Tajawal', sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .results {
            margin-top: 15px;
            padding: 10px;
            background: #e9ecef;
            border-radius: 5px;
            max-height: 300px;
            overflow-y: auto;
        }
        .search-input {
            width: 300px;
            padding: 10px;
            border: 2px solid #007bff;
            border-radius: 5px;
            margin: 10px;
        }
        .status-active { color: #28a745; font-weight: bold; }
        .status-expired { color: #dc3545; font-weight: bold; }
        .status-empty { color: #6c757d; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>๐ ุงุฎุชุจุงุฑ ุฅุตูุงุญ ุงูุจุญุซ ุงููุฑูู</h1>
        
        <div class="test-section">
            <h3>๐ ุงููุดููุฉ ุงููุทููุจ ุญููุง:</h3>
            <ul>
                <li>ุงูุจุญุซ ุนู "ูุดุท" ุจุดูู ุนุงู ูุนูู โ</li>
                <li>ุงูุจุญุซ ุนู "ุงูุฑูุงุถ//ูุดุท" ููุธูุฑ ูุญุฏุงุช ููุชููุฉ โ</li>
                <li>ุงูุจุญุซ ูุง ูุฏุนู "ูุดุท//ุงูุฑูุงุถ" โ</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>๐งช ุงุฎุชุจุงุฑุงุช ุงูุจุญุซ:</h3>
            <button class="test-button" onclick="testBasicSearch()">ุงุฎุชุจุงุฑ ุงูุจุญุซ ุงูุฃุณุงุณู</button>
            <button class="test-button" onclick="testHierarchicalSearch()">ุงุฎุชุจุงุฑ ุงูุจุญุซ ุงููุฑูู</button>
            <button class="test-button" onclick="testReversedSearch()">ุงุฎุชุจุงุฑ ุงูุจุญุซ ุงููุนููุณ</button>
            <button class="test-button" onclick="testAllSearchTypes()">ุงุฎุชุจุงุฑ ุดุงูู</button>
        </div>

        <div class="test-section">
            <h3>๐ ุจุญุซ ูุฎุตุต:</h3>
            <input type="text" class="search-input" id="customSearch" placeholder="ุฃุฏุฎู ุงุณุชุนูุงู ุงูุจุญุซ...">
            <button class="test-button" onclick="testCustomSearch()">ุชูููุฐ ุงูุจุญุซ</button>
        </div>

        <div class="test-section">
            <h3>๐ ุงููุชุงุฆุฌ:</h3>
            <div id="results" class="results">
                <p>ุงุถุบุท ุนูู ุฃู ุฒุฑ ูุจุฏุก ุงูุงุฎุชุจุงุฑ...</p>
            </div>
        </div>
    </div>

    <!-- ุชุญููู ุงููููุงุช ุงููุทููุจุฉ -->
    <script>
        // ุจูุงูุงุช ุงุฎุชุจุงุฑ ูุญุณูุฉ ูุชุบุทูุฉ ุฌููุน ุงูุญุงูุงุช
        const testData = [
            {
                'ุงุณู ุงูุนูุงุฑ': 'ูุฌูุน ุงูุดูุณ',
                'ุงููุฏููุฉ': 'ุงูุฑูุงุถ',
                'ุฑูู  ุงููุญุฏุฉ ': '101',
                'ุงุณู ุงููุณุชุฃุฌุฑ': 'ุฃุญูุฏ ูุญูุฏ',
                'ุงููุงูู': 'ุดุฑูุฉ ุงูุณููุฏู',
                'ุชุงุฑูุฎ ุงูุจุฏุงูุฉ': '2024-01-01',
                'ุชุงุฑูุฎ ุงูููุงูุฉ': '2025-12-31',
                'ููุน ุงูุนูุฏ': 'ุถุฑูุจู'
            },
            {
                'ุงุณู ุงูุนูุงุฑ': 'ูุฌูุน ุงูููุฑ',
                'ุงููุฏููุฉ': 'ุงูุฑูุงุถ',
                'ุฑูู  ุงููุญุฏุฉ ': '102',
                'ุงุณู ุงููุณุชุฃุฌุฑ': '',
                'ุงููุงูู': '',
                'ุชุงุฑูุฎ ุงูุจุฏุงูุฉ': '',
                'ุชุงุฑูุฎ ุงูููุงูุฉ': '',
                'ููุน ุงูุนูุฏ': 'ุณููู'
            },
            {
                'ุงุณู ุงูุนูุงุฑ': 'ุจุฑุฌ ุงูุฃุนูุงู',
                'ุงููุฏููุฉ': 'ุฌุฏุฉ',
                'ุฑูู  ุงููุญุฏุฉ ': '201',
                'ุงุณู ุงููุณุชุฃุฌุฑ': 'ุณุงุฑุฉ ุฃุญูุฏ',
                'ุงููุงูู': 'ุดุฑูุฉ ุงูุณููุฏู',
                'ุชุงุฑูุฎ ุงูุจุฏุงูุฉ': '2023-01-01',
                'ุชุงุฑูุฎ ุงูููุงูุฉ': '2023-12-31',
                'ููุน ุงูุนูุฏ': 'ุชุฌุงุฑู'
            },
            {
                'ุงุณู ุงูุนูุงุฑ': 'ูุฌูุน ุงูุดูุณ',
                'ุงููุฏููุฉ': 'ุงูุฑูุงุถ',
                'ุฑูู  ุงููุญุฏุฉ ': '103',
                'ุงุณู ุงููุณุชุฃุฌุฑ': 'ูุญูุฏ ุนูู',
                'ุงููุงูู': 'ุดุฑูุฉ ุงูุณููุฏู',
                'ุชุงุฑูุฎ ุงูุจุฏุงูุฉ': '2023-06-01',
                'ุชุงุฑูุฎ ุงูููุงูุฉ': '2025-01-15',
                'ููุน ุงูุนูุฏ': 'ุถุฑูุจู'
            },
            {
                'ุงุณู ุงูุนูุงุฑ': 'ูุฌูุน ุงูุดูุณ',
                'ุงููุฏููุฉ': 'ุงูุฑูุงุถ',
                'ุฑูู  ุงููุญุฏุฉ ': '104',
                'ุงุณู ุงููุณุชุฃุฌุฑ': 'ูุงุทูุฉ ุณุงูู',
                'ุงููุงูู': 'ุดุฑูุฉ ุงูุณููุฏู',
                'ุชุงุฑูุฎ ุงูุจุฏุงูุฉ': '2024-01-01',
                'ุชุงุฑูุฎ ุงูููุงูุฉ': '2024-12-31',
                'ุชุงุฑูุฎ ููุงูุฉ ุงููุณุท': '2025-01-10',
                'ููุน ุงูุนูุฏ': 'ุถุฑูุจู'
            }
        ];

        // ุฏุงูุฉ ุชุญููู ุงูุชุงุฑูุฎ
        function parseDate(dateStr) {
            if (!dateStr) return null;
            const date = new Date(dateStr);
            return isNaN(date.getTime()) ? null : date;
        }

        // ุฏุงูุฉ ุญุณุงุจ ุงูุญุงูุฉ ุงููุทุงุจูุฉ ูููุธุงู ุงูุญูููู
        function calculateStatus(property) {
            if (!property['ุงุณู ุงููุณุชุฃุฌุฑ'] || !property['ุงููุงูู']) {
                return { final: 'ูุงุฑุบ', display: 'ูุงุฑุบ', isInstallmentEnded: false };
            }

            const today = new Date();

            // ุฃููุงู: ุงูุชุญูู ูู ุชุงุฑูุฎ ููุงูุฉ ุงููุณุท
            if (property['ุชุงุฑูุฎ ููุงูุฉ ุงููุณุท']) {
                const installmentEndDate = parseDate(property['ุชุงุฑูุฎ ููุงูุฉ ุงููุณุท']);
                if (installmentEndDate) {
                    const diffDays = Math.floor((installmentEndDate - today) / (1000 * 60 * 60 * 24));

                    if (diffDays < 0) {
                        return {
                            final: 'ููุชูู',
                            display: `ุฃูุณุงุท ููุชููุฉ ููุฐ ${Math.abs(diffDays)} ููู`,
                            isInstallmentEnded: true
                        };
                    } else if (diffDays <= 60) {
                        return {
                            final: 'ุนูู ูุดู',
                            display: `ุฃูุณุงุท ุนูู ูุดู ุงูุงูุชูุงุก ุจุนุฏ ${diffDays} ููู`,
                            isInstallmentEnded: false,
                            isPending: true
                        };
                    } else {
                        return {
                            final: 'ูุนุงู',
                            display: 'ูุนุงู',
                            isInstallmentEnded: false
                        };
                    }
                }
            }

            // ุฅุฐุง ูู ููุฌุฏ ุฃูุณุงุทุ ุงุณุชุฎุฏู ุชุงุฑูุฎ ุงูููุงูุฉ
            if (property['ุชุงุฑูุฎ ุงูููุงูุฉ']) {
                const contractDate = parseDate(property['ุชุงุฑูุฎ ุงูููุงูุฉ']);
                if (contractDate) {
                    const diffDays = Math.floor((contractDate - today) / (1000 * 60 * 60 * 24));
                    if (diffDays < 0) {
                        return { final: 'ููุชูู', display: `ููุชูู ููุฐ ${Math.abs(diffDays)} ููู`, isInstallmentEnded: false };
                    } else if (diffDays <= 60) {
                        return { final: 'ุนูู ูุดู', display: `ุณููุชูู ุจุนุฏ ${diffDays} ููู`, isInstallmentEnded: false };
                    } else {
                        return { final: 'ูุนุงู', display: 'ูุนุงู', isInstallmentEnded: false };
                    }
                }
            }

            return { final: 'ูุนุงู', display: 'ูุนุงู', isInstallmentEnded: false };
        }

        // ุชุนููู ุงูุจูุงูุงุช ูููุงูุฐุฉ ุงูุนุงูุฉ
        window.allData = testData;
        window.calculateStatus = calculateStatus;

        function logResult(message, type = 'info') {
            const results = document.getElementById('results');
            const color = type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#007bff';
            results.innerHTML += `<div style="color: ${color}; margin: 5px 0;">${message}</div>`;
            results.scrollTop = results.scrollHeight;
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        function testBasicSearch() {
            clearResults();
            logResult('๐งช ุงุฎุชุจุงุฑ ุงูุจุญุซ ุงูุฃุณุงุณู...', 'info');
            
            const queries = ['ูุดุท', 'ูุนุงู', 'ููุชูู', 'ูุงุฑุบ'];
            
            queries.forEach(query => {
                logResult(`\n๐ ุงูุจุญุซ ุนู: "${query}"`);
                
                if (typeof performAdvancedSearch === 'function') {
                    const results = performAdvancedSearch(query, testData);
                    logResult(`๐ ุงููุชุงุฆุฌ: ${results.length} ุนูุงุฑ`);
                    
                    results.forEach((item, index) => {
                        const status = calculateStatus(item);
                        logResult(`   ${index + 1}. ${item['ุงุณู ุงูุนูุงุฑ']} - ${item['ุฑูู  ุงููุญุฏุฉ ']} - ${status.final}`, 'success');
                    });
                } else {
                    logResult('โ ุฏุงูุฉ ุงูุจุญุซ ุงููุชูุฏู ุบูุฑ ูุชููุฑุฉ', 'error');
                }
            });
        }

        function testHierarchicalSearch() {
            clearResults();
            logResult('๐งช ุงุฎุชุจุงุฑ ุงูุจุญุซ ุงููุฑูู...', 'info');
            
            const queries = [
                'ุงูุฑูุงุถ//ูุดุท',
                'ุงูุฑูุงุถ//ูุนุงู', 
                'ุงูุฑูุงุถ//ููุชูู',
                'ุงูุฑูุงุถ//ูุงุฑุบ'
            ];
            
            queries.forEach(query => {
                logResult(`\n๐ ุงูุจุญุซ ุนู: "${query}"`);
                
                if (typeof performAdvancedSearch === 'function') {
                    const results = performAdvancedSearch(query, testData);
                    logResult(`๐ ุงููุชุงุฆุฌ: ${results.length} ุนูุงุฑ`);
                    
                    results.forEach((item, index) => {
                        const status = calculateStatus(item);
                        logResult(`   ${index + 1}. ${item['ุงุณู ุงูุนูุงุฑ']} - ${item['ุฑูู  ุงููุญุฏุฉ ']} - ${item['ุงููุฏููุฉ']} - ${status.final}`, 'success');
                    });
                } else {
                    logResult('โ ุฏุงูุฉ ุงูุจุญุซ ุงููุชูุฏู ุบูุฑ ูุชููุฑุฉ', 'error');
                }
            });
        }

        function testReversedSearch() {
            clearResults();
            logResult('๐งช ุงุฎุชุจุงุฑ ุงูุจุญุซ ุงููุนููุณ...', 'info');
            
            const queries = [
                'ูุดุท//ุงูุฑูุงุถ',
                'ูุนุงู//ุงูุฑูุงุถ', 
                'ููุชูู//ุงูุฑูุงุถ',
                'ูุงุฑุบ//ุงูุฑูุงุถ'
            ];
            
            queries.forEach(query => {
                logResult(`\n๐ ุงูุจุญุซ ุนู: "${query}"`);
                
                if (typeof performAdvancedSearch === 'function') {
                    const results = performAdvancedSearch(query, testData);
                    logResult(`๐ ุงููุชุงุฆุฌ: ${results.length} ุนูุงุฑ`);
                    
                    results.forEach((item, index) => {
                        const status = calculateStatus(item);
                        logResult(`   ${index + 1}. ${item['ุงุณู ุงูุนูุงุฑ']} - ${item['ุฑูู  ุงููุญุฏุฉ ']} - ${item['ุงููุฏููุฉ']} - ${status.final}`, 'success');
                    });
                } else {
                    logResult('โ ุฏุงูุฉ ุงูุจุญุซ ุงููุชูุฏู ุบูุฑ ูุชููุฑุฉ', 'error');
                }
            });
        }

        function testAllSearchTypes() {
            clearResults();
            logResult('๐งช ุงุฎุชุจุงุฑ ุดุงูู ูุฌููุน ุฃููุงุน ุงูุจุญุซ...', 'info');
            
            testBasicSearch();
            testHierarchicalSearch();
            testReversedSearch();
        }

        function testCustomSearch() {
            const query = document.getElementById('customSearch').value.trim();
            if (!query) {
                alert('ูุฑุฌู ุฅุฏุฎุงู ุงุณุชุนูุงู ุงูุจุญุซ');
                return;
            }
            
            clearResults();
            logResult(`๐ ุงูุจุญุซ ุงููุฎุตุต: "${query}"`, 'info');
            
            if (typeof performAdvancedSearch === 'function') {
                const results = performAdvancedSearch(query, testData);
                logResult(`๐ ุงููุชุงุฆุฌ: ${results.length} ุนูุงุฑ`);
                
                results.forEach((item, index) => {
                    const status = calculateStatus(item);
                    logResult(`   ${index + 1}. ${item['ุงุณู ุงูุนูุงุฑ']} - ${item['ุฑูู  ุงููุญุฏุฉ ']} - ${item['ุงููุฏููุฉ']} - ${status.final}`, 'success');
                });
            } else {
                logResult('โ ุฏุงูุฉ ุงูุจุญุซ ุงููุชูุฏู ุบูุฑ ูุชููุฑุฉ', 'error');
            }
        }
    </script>

    <!-- ุชุญููู ูุธุงู ุงูุจุญุซ ุงููุชูุฏู -->
    <script src="advanced-search-system.js"></script>
</body>
</html>
